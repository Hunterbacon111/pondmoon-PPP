# Ancora Property Analysis Dashboard

## Project Overview

Python ETL + reporting tool that extracts data from spreadsheets, PDFs, and DOCX files, then generates a self-contained interactive HTML dashboard for the **Ancora (1st & Beech Residential)** apartment property in San Diego, CA.

## Property Summary

- **Name**: Ancora (1st & Beech Residential)
- **Address**: 110 Beech St, San Diego, CA 92101 (Little Italy)
- **Units**: 220 (214 market rate + 6 affordable at 50% AMI)
- **Construction**: 22-Story High-Rise, completed 2025
- **Loan**: SBLIC Construction, $73M, SOFR+4.50% floating rate
- **PM**: Greystar
- **Investors**: Pondmoon Capital (80%), Greystar (13%), Land Seller LP (7%)
- **Status**: Lease-up phase, targeting 95% stabilized occupancy by May 2026

## Quick Start

```bash
# Activate virtual environment
source .venv/bin/activate

# Build the dashboard (extracts data + generates HTML)
python3 build.py

# Open the output
open dashboard/index.html
```

## Architecture

```
build.py                    # Entry point
src/
  config.py                 # Property metadata, paths, budget row mappings
  build_data.py             # Orchestrates all extractors → data_output/*.json
  build_html.py             # Injects JSON into template → dashboard/index.html
  extractors/
    budget.py               # Monthly budget from XLSX (row-mapped)
    leasing.py              # Weekly leasing metrics from XLSX
    financials.py           # T-12 PDF parsing (with hardcoded fallback)
    minutes.py              # Meeting minutes DOCX (bilingual EN/ZH)
    comps.py                # Comparable properties (hardcoded from PDF)
    loan_info.py            # SBLIC loan terms, interest scenarios
    action_plan.py          # Synthesized action items from meetings
    emails.py               # Email parsing (stub - no data yet)
    companions.py           # Companion properties (stub - none for Ancora)
templates/
  dashboard_template.html   # 4500+ line HTML template with JS injection points
dashboard/
  index.html                # Generated output (~13MB, fully self-contained)
data_output/                # Intermediate JSON files (generated by build)
```

## Build Pipeline

1. **Extract** — `src/build_data.py:extract_all()` calls each extractor, writes JSON to `data_output/`
2. **Render** — `src/build_html.py:generate_dashboard()` loads template, injects JSON via `/* __PLACEHOLDER__ */` markers, writes `dashboard/index.html`

The output is a single self-contained HTML file (CSS, JS, JSON data, and base64 images all embedded).

## Data Sources

| Directory | Contents | Format |
|-----------|----------|--------|
| `Data_Annual_Budget/` | Cash flow projections | XLSX |
| `Data_Leasing/` | Weekly leasing updates | XLSX |
| `Data_Financials/` | T-12 financial statement | PDF |
| `Data_Minutes/` | Meeting minutes (EN + ZH) | DOCX |
| `Data_Comps/` | Market comparables | PDF |
| `Data_Loan/` | SBLIC term sheet | PDF |
| `Data_Project Information/` | Debt memo, photos | PDF, JPG |
| `Data_Marketing_Others/` | Marketing materials | (empty) |
| `Data_T12P&L/` | T-12 P&L data | (empty) |

## Key Configuration

All property metadata, directory paths, and budget row mappings live in `src/config.py`:
- `PROPERTY` dict — static metadata (units, loan, equity, contacts)
- `BUDGET_ROW_MAP` — 1-indexed row numbers from the budget XLSX
- `BUDGET_DATA_COL_START = 6` (column F = Jan), `BUDGET_TOTAL_COL = 18` (column R)
- `DATA_*` — paths to each data source directory

## Dependencies

- Python 3.14+ (via `.venv`)
- `openpyxl` — XLSX parsing (budget, leasing)
- `pdfplumber` — PDF text extraction (T-12, loan docs)
- `python-docx` — DOCX parsing (meeting minutes)
- `PyPDF2` — PDF utilities

## Development Notes

- **Template placeholders** use the format `/* __NAME_JSON__ */` for data injection
- **Budget extractor** uses row-based mapping from `BUDGET_ROW_MAP` — update config if the XLSX layout changes
- **Comps data** is hardcoded in `src/extractors/comps.py` — update manually when new comp data arrives
- **Financials extractor** has hardcoded fallback values when PDF parsing fails
- **Meeting minutes** parser handles bilingual (English + Chinese) documents
- `explore_cashflow.py` is a dev utility for inspecting XLSX structure

## Coding Conventions

- Each extractor returns a dict/list and is called by `build_data.py`
- Config is centralized in `src/config.py` — avoid hardcoding paths or property data in extractors
- Keep the dashboard template (`templates/dashboard_template.html`) as the single source of truth for layout/styling
- The generated `dashboard/index.html` should never be edited directly — it gets overwritten on every build
